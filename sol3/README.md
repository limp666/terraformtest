# Sol3.
## Description
 - Nginx image build terraform based on AZ

## Build
```
terraform init
terraform plan
terraform apply -auto-approve
```

## Destroy
```
terrafom destroy -auto-approve
```

## Usage
```
d1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libxpm4:amd64.
aws_instance.example2 (remote-exec): Preparing to unpack .../08-libxpm4_1%3a3.5.12-1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libxpm4:amd64 (1:3.5.12-1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libgd3:amd64.
aws_instance.example2 (remote-exec): Preparing to unpack .../09-libgd3_2.2.5-5.2ubuntu2_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libgd3:amd64 (2.2.5-5.2ubuntu2) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package nginx-common.
aws_instance.example2 (remote-exec): Preparing to unpack .../10-nginx-common_1.17.10-0ubuntu1_all.deb ...
aws_instance.example2 (remote-exec): Unpacking nginx-common (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libnginx-mod-http-image-filter.
aws_instance.example2 (remote-exec): Preparing to unpack .../11-libnginx-mod-http-image-filter_1.17.10-0ubuntu1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libnginx-mod-http-image-filter (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libnginx-mod-http-xslt-filter.
aws_instance.example2 (remote-exec): Preparing to unpack .../12-libnginx-mod-http-xslt-filter_1.17.10-0ubuntu1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libnginx-mod-http-xslt-filter (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libnginx-mod-mail.
aws_instance.example2 (remote-exec): Preparing to unpack .../13-libnginx-mod-mail_1.17.10-0ubuntu1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libnginx-mod-mail (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libnginx-mod-stream.
aws_instance.example2 (remote-exec): Preparing to unpack .../14-libnginx-mod-stream_1.17.10-0ubuntu1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libnginx-mod-stream (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package nginx-core.
aws_instance.example2 (remote-exec): Preparing to unpack .../15-nginx-core_1.17.10-0ubuntu1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking nginx-core (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package nginx.
aws_instance.example2 (remote-exec): Preparing to unpack .../16-nginx_1.17.10-0ubuntu1_all.deb ...
aws_instance.example2 (remote-exec): Unpacking nginx (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up libxpm4:amd64 (1:3.5.12-1) ...
aws_instance.example2 (remote-exec): Setting up nginx-common (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Created symlink /etc/systemd/system/multi-user.target.wants/nginx.service → /lib/systemd/system/nginx.service.

aws_instance.example2 (remote-exec): Setting up libjbig0:amd64 (2.1-3.1build1) ...
aws_instance.example2 (remote-exec): Setting up libnginx-mod-http-xslt-filter (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up libwebp6:amd64 (0.6.1-2) ...
aws_instance.example2 (remote-exec): Setting up fonts-dejavu-core (2.37-1) ...
aws_instance.example1: Creation complete after 1m13s [id=i-09465e1e938594837]
aws_instance.example2 (remote-exec): Setting up libjpeg-turbo8:amd64 (2.0.3-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up libjpeg8:amd64 (8c-2ubuntu8) ...
aws_instance.example2 (remote-exec): Setting up libnginx-mod-mail (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up fontconfig-config (2.13.1-2ubuntu3) ...
aws_instance.example2 (remote-exec): Setting up libnginx-mod-stream (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up libtiff5:amd64 (4.1.0+git191117-2build1) ...
aws_instance.example2 (remote-exec): Setting up libfontconfig1:amd64 (2.13.1-2ubuntu3) ...
aws_instance.example2 (remote-exec): Setting up libgd3:amd64 (2.2.5-5.2ubuntu2) ...
aws_instance.example2 (remote-exec): Setting up libnginx-mod-http-image-filter (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up nginx-core (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up nginx (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Processing triggers for ufw (0.36-6) ...
aws_instance.example2 (remote-exec): Processing triggers for systemd (245.4-4ubuntu3) ...
aws_instance.example2 (remote-exec): Processing triggers for man-db (2.9.1-1) ...
aws_instance.example2 (remote-exec): Processing triggers for libc-bin (2.31-0ubuntu9) ...
aws_instance.example3: Creation complete after 1m16s [id=i-05f8445c8abd7739e]
aws_instance.example2: Creation complete after 1m19s [id=i-0f862c23f128f5bfb]

Apply complete! Resources: 17 added, 0 changed, 0 destroyed.
            "public_ip": "3.249.113.78",
            "public_ip": "34.249.117.106",
            "public_ip": "54.246.26.96",


            sol3 git:(master) ✗ curl 3.249.113.78
            <!DOCTYPE html>
            <html>
            <head>
            <title>Welcome to nginx!</title>
            <style>
                body {
                    width: 35em;
                    margin: 0 auto;
                    font-family: Tahoma, Verdana, Arial, sans-serif;
                }
            </style>
            </head>
            <body>
            <h1>Welcome to nginx!</h1>
            <p>If you see this page, the nginx web server is successfully installed and
            working. Further configuration is required.</p>

            <p>For online documentation and support please refer to
            <a href="http://nginx.org/">nginx.org</a>.<br/>
            Commercial support is available at
            <a href="http://nginx.com/">nginx.com</a>.</p>

            <p><em>Thank you for using nginx.</em></p>
            </body>
            </html>
```

```
s_instance.example2 (remote-exec): Unpacking libjpeg8:amd64 (8c-2ubuntu8) ...
aws_instance.example3 (remote-exec): Processing triggers for libc-bin (2.31-0ubuntu9) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libjbig0:amd64.
aws_instance.example2 (remote-exec): Preparing to unpack .../05-libjbig0_2.1-3.1build1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libjbig0:amd64 (2.1-3.1build1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libwebp6:amd64.
aws_instance.example2 (remote-exec): Preparing to unpack .../06-libwebp6_0.6.1-2_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libwebp6:amd64 (0.6.1-2) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libtiff5:amd64.
aws_instance.example2 (remote-exec): Preparing to unpack .../07-libtiff5_4.1.0+git191117-2build1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libtiff5:amd64 (4.1.0+git191117-2build1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libxpm4:amd64.
aws_instance.example2 (remote-exec): Preparing to unpack .../08-libxpm4_1%3a3.5.12-1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libxpm4:amd64 (1:3.5.12-1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libgd3:amd64.
aws_instance.example2 (remote-exec): Preparing to unpack .../09-libgd3_2.2.5-5.2ubuntu2_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libgd3:amd64 (2.2.5-5.2ubuntu2) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package nginx-common.
aws_instance.example2 (remote-exec): Preparing to unpack .../10-nginx-common_1.17.10-0ubuntu1_all.deb ...
aws_instance.example2 (remote-exec): Unpacking nginx-common (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libnginx-mod-http-image-filter.
aws_instance.example2 (remote-exec): Preparing to unpack .../11-libnginx-mod-http-image-filter_1.17.10-0ubuntu1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libnginx-mod-http-image-filter (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libnginx-mod-http-xslt-filter.
aws_instance.example2 (remote-exec): Preparing to unpack .../12-libnginx-mod-http-xslt-filter_1.17.10-0ubuntu1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libnginx-mod-http-xslt-filter (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libnginx-mod-mail.
aws_instance.example2 (remote-exec): Preparing to unpack .../13-libnginx-mod-mail_1.17.10-0ubuntu1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libnginx-mod-mail (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package libnginx-mod-stream.
aws_instance.example2 (remote-exec): Preparing to unpack .../14-libnginx-mod-stream_1.17.10-0ubuntu1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking libnginx-mod-stream (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package nginx-core.
aws_instance.example2 (remote-exec): Preparing to unpack .../15-nginx-core_1.17.10-0ubuntu1_amd64.deb ...
aws_instance.example2 (remote-exec): Unpacking nginx-core (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Selecting previously unselected package nginx.
aws_instance.example2 (remote-exec): Preparing to unpack .../16-nginx_1.17.10-0ubuntu1_all.deb ...
aws_instance.example2 (remote-exec): Unpacking nginx (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up libxpm4:amd64 (1:3.5.12-1) ...
aws_instance.example2 (remote-exec): Setting up nginx-common (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Created symlink /etc/systemd/system/multi-user.target.wants/nginx.service → /lib/systemd/system/nginx.service.

aws_instance.example2 (remote-exec): Setting up libjbig0:amd64 (2.1-3.1build1) ...
aws_instance.example2 (remote-exec): Setting up libnginx-mod-http-xslt-filter (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up libwebp6:amd64 (0.6.1-2) ...
aws_instance.example2 (remote-exec): Setting up fonts-dejavu-core (2.37-1) ...
aws_instance.example1: Creation complete after 1m13s [id=i-09465e1e938594837]
aws_instance.example2 (remote-exec): Setting up libjpeg-turbo8:amd64 (2.0.3-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up libjpeg8:amd64 (8c-2ubuntu8) ...
aws_instance.example2 (remote-exec): Setting up libnginx-mod-mail (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up fontconfig-config (2.13.1-2ubuntu3) ...
aws_instance.example2 (remote-exec): Setting up libnginx-mod-stream (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up libtiff5:amd64 (4.1.0+git191117-2build1) ...
aws_instance.example2 (remote-exec): Setting up libfontconfig1:amd64 (2.13.1-2ubuntu3) ...
aws_instance.example2 (remote-exec): Setting up libgd3:amd64 (2.2.5-5.2ubuntu2) ...
aws_instance.example2 (remote-exec): Setting up libnginx-mod-http-image-filter (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up nginx-core (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Setting up nginx (1.17.10-0ubuntu1) ...
aws_instance.example2 (remote-exec): Processing triggers for ufw (0.36-6) ...
aws_instance.example2 (remote-exec): Processing triggers for systemd (245.4-4ubuntu3) ...
aws_instance.example2 (remote-exec): Processing triggers for man-db (2.9.1-1) ...
aws_instance.example2 (remote-exec): Processing triggers for libc-bin (2.31-0ubuntu9) ...
aws_instance.example3: Creation complete after 1m16s [id=i-05f8445c8abd7739e]
aws_instance.example2: Creation complete after 1m19s [id=i-0f862c23f128f5bfb]

Apply complete! Resources: 17 added, 0 changed, 0 destroyed.
            "public_ip": "3.249.113.78",
            "public_ip": "34.249.117.106",
            "public_ip": "54.246.26.96",
            "map_public_ip_on_launch": false,
            "map_public_ip_on_launch": false,
            "map_public_ip_on_launch": false,
            "map_public_ip_on_launch": true,
            "map_public_ip_on_launch": true,
            "map_public_ip_on_launch": true,
➜  sol3 git:(master) ✗
➜  sol3 git:(master) ✗
➜  sol3 git:(master) ✗
➜  sol3 git:(master) ✗ curl 3.249.113.78
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
➜  sol3 git:(master) ✗ td
aws_key_pair.mykey: Refreshing state... [id=mykey]
aws_vpc.main: Refreshing state... [id=vpc-02c0f987e4d56b6a2]
aws_subnet.main-public-2: Refreshing state... [id=subnet-0c966c18cf9c2c30b]
aws_subnet.main-public-1: Refreshing state... [id=subnet-0a436805e862a9ca4]
aws_subnet.main-private-2: Refreshing state... [id=subnet-082ccdfafd2f3c785]
aws_internet_gateway.main-gw: Refreshing state... [id=igw-08f057fc7f8637648]
aws_subnet.main-private-1: Refreshing state... [id=subnet-0615b04d15afbc813]
aws_subnet.main-private-3: Refreshing state... [id=subnet-04cc2639bbf70f189]
aws_security_group.allow-ssh: Refreshing state... [id=sg-02c8ef542e124c9d3]
aws_subnet.main-public-3: Refreshing state... [id=subnet-06648f1911ea63e4d]
aws_route_table.main-public: Refreshing state... [id=rtb-0da2a12b8454fa4bf]
aws_instance.example3: Refreshing state... [id=i-05f8445c8abd7739e]
aws_instance.example2: Refreshing state... [id=i-0f862c23f128f5bfb]
aws_instance.example1: Refreshing state... [id=i-09465e1e938594837]
aws_route_table_association.main-public-2-a: Refreshing state... [id=rtbassoc-09b0c44f7799b1d1e]
aws_route_table_association.main-public-3-a: Refreshing state... [id=rtbassoc-0296f6d46de227838]
aws_route_table_association.main-public-1-a: Refreshing state... [id=rtbassoc-01a8dc8ed64a6750d]
aws_route_table_association.main-public-3-a: Destroying... [id=rtbassoc-0296f6d46de227838]
aws_route_table_association.main-public-2-a: Destroying... [id=rtbassoc-09b0c44f7799b1d1e]
aws_route_table_association.main-public-1-a: Destroying... [id=rtbassoc-01a8dc8ed64a6750d]
aws_subnet.main-private-1: Destroying... [id=subnet-0615b04d15afbc813]
aws_subnet.main-private-2: Destroying... [id=subnet-082ccdfafd2f3c785]
aws_subnet.main-private-3: Destroying... [id=subnet-04cc2639bbf70f189]
aws_instance.example3: Destroying... [id=i-05f8445c8abd7739e]
aws_instance.example2: Destroying... [id=i-0f862c23f128f5bfb]
aws_instance.example1: Destroying... [id=i-09465e1e938594837]
aws_route_table_association.main-public-2-a: Destruction complete after 1s
aws_route_table_association.main-public-1-a: Destruction complete after 1s
aws_route_table_association.main-public-3-a: Destruction complete after 1s
aws_route_table.main-public: Destroying... [id=rtb-0da2a12b8454fa4bf]
aws_subnet.main-private-2: Destruction complete after 2s
aws_subnet.main-private-1: Destruction complete after 3s
aws_subnet.main-private-3: Destruction complete after 3s
aws_route_table.main-public: Destruction complete after 4s
aws_internet_gateway.main-gw: Destroying... [id=igw-08f057fc7f8637648]
aws_instance.example3: Still destroying... [id=i-05f8445c8abd7739e, 10s elapsed]
aws_instance.example2: Still destroying... [id=i-0f862c23f128f5bfb, 10s elapsed]
aws_instance.example1: Still destroying... [id=i-09465e1e938594837, 10s elapsed]
aws_internet_gateway.main-gw: Still destroying... [id=igw-08f057fc7f8637648, 10s elapsed]
aws_instance.example3: Still destroying... [id=i-05f8445c8abd7739e, 20s elapsed]
aws_instance.example1: Still destroying... [id=i-09465e1e938594837, 20s elapsed]
aws_instance.example2: Still destroying... [id=i-0f862c23f128f5bfb, 20s elapsed]
aws_internet_gateway.main-gw: Destruction complete after 17s
aws_instance.example1: Destruction complete after 26s
aws_subnet.main-public-1: Destroying... [id=subnet-0a436805e862a9ca4]
aws_instance.example2: Destruction complete after 26s
aws_subnet.main-public-2: Destroying... [id=subnet-0c966c18cf9c2c30b]
aws_instance.example3: Destruction complete after 26s
aws_key_pair.mykey: Destroying... [id=mykey]
aws_subnet.main-public-3: Destroying... [id=subnet-06648f1911ea63e4d]
aws_security_group.allow-ssh: Destroying... [id=sg-02c8ef542e124c9d3]
aws_key_pair.mykey: Destruction complete after 2s
aws_security_group.allow-ssh: Destruction complete after 4s
aws_subnet.main-public-1: Destruction complete after 4s
aws_subnet.main-public-2: Destruction complete after 4s
aws_subnet.main-public-3: Destruction complete after 4s
aws_vpc.main: Destroying... [id=vpc-02c0f987e4d56b6a2]
aws_vpc.main: Destruction complete after 2s

Destroy complete! Resources: 17 destroyed.
```
